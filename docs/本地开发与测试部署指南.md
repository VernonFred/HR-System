# QZÂ·TalentLens æœ¬åœ°å¼€å‘ä¸æµ‹è¯•éƒ¨ç½²æŒ‡å—

> **ç‰ˆæœ¬**: v2.0  
> **æ›´æ–°æ—¥æœŸ**: 2025å¹´12æœˆ12æ—¥  
> **é€‚ç”¨åœºæ™¯**: æœ¬åœ°å¼€å‘ã€å†…ç½‘æµ‹è¯•ã€å¤–ç½‘ä¸´æ—¶æµ‹è¯•

---

## ğŸ“‹ ç›®å½•

1. [æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨](#ä¸€æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨)
2. [å†…ç½‘æµ‹è¯•éƒ¨ç½²](#äºŒå†…ç½‘æµ‹è¯•éƒ¨ç½²)
3. [Ngrokå¤–ç½‘è®¿é—®](#ä¸‰ngrokå¤–ç½‘è®¿é—®)
4. [åŸŸåé…ç½®è¯´æ˜](#å››åŸŸåé…ç½®è¯´æ˜)
5. [æµ‹è¯„é“¾æ¥å’ŒäºŒç»´ç ](#äº”æµ‹è¯„é“¾æ¥å’ŒäºŒç»´ç )
6. [å¸¸è§é—®é¢˜](#å…­å¸¸è§é—®é¢˜)

---

## ä¸€ã€æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨

### 1.1 å¿«é€Ÿå¯åŠ¨ï¼ˆå¼€å‘æ¨¡å¼ï¼‰

#### æ­¥éª¤1: å¯åŠ¨åç«¯æœåŠ¡

```bash
# æ‰“å¼€ç»ˆç«¯1
cd /Users/Pythoné¡¹ç›®/HRäººäº‹/backend

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœä½¿ç”¨venvï¼‰
source venv/bin/activate
# æˆ–ä½¿ç”¨Poetry
poetry shell

# å¯åŠ¨åç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼Œæ”¯æŒçƒ­é‡è½½ï¼‰
uvicorn app.main:app --reload --host 0.0.0.0 --port 9000

# çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼š
# INFO:     Uvicorn running on http://0.0.0.0:9000 (Press CTRL+C to quit)
# INFO:     Started reloader process
```

**é‡è¦å‚æ•°è¯´æ˜ï¼š**
- `--reload`: ä»£ç ä¿®æ”¹åè‡ªåŠ¨é‡å¯ï¼ˆä»…å¼€å‘ç¯å¢ƒä½¿ç”¨ï¼‰
- `--host 0.0.0.0`: å…è®¸å±€åŸŸç½‘è®¿é—®ï¼ˆé‡è¦ï¼ç”¨äºæ‰‹æœºæµ‹è¯•ï¼‰
- `--port 9000`: åç«¯APIç«¯å£

#### æ­¥éª¤2: å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
# æ‰“å¼€ç»ˆç«¯2ï¼ˆæ–°å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼‰
cd /Users/Pythoné¡¹ç›®/HRäººäº‹/frontend

# å¯åŠ¨å‰ç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼Œæ”¯æŒçƒ­é‡è½½ï¼‰
npm run dev

# çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼š
# VITE v5.0.0  ready in 500 ms
# âœ  Local:   http://localhost:5173/
# âœ  Network: http://192.168.1.100:5173/
```

**æ³¨æ„Networkåœ°å€**ï¼šè¿™æ˜¯å±€åŸŸç½‘IPï¼Œç”¨äºæ‰‹æœºæˆ–å…¶ä»–è®¾å¤‡è®¿é—®ï¼

#### æ­¥éª¤3: è®¿é—®ç³»ç»Ÿ

```
æœ¬åœ°è®¿é—®:
- å‰ç«¯: http://localhost:5173
- åç«¯API: http://localhost:9000
- APIæ–‡æ¡£: http://localhost:9000/docs

å±€åŸŸç½‘è®¿é—®ï¼ˆåŒä¸€WiFiä¸‹ï¼‰:
- å‰ç«¯: http://192.168.1.100:5173  ï¼ˆä½ çš„å®é™…IPï¼‰
- åç«¯API: http://192.168.1.100:9000
```

### 1.2 è·å–æœ¬æœºIPåœ°å€

```bash
# macOS
ifconfig | grep "inet " | grep -v 127.0.0.1

# è¾“å‡ºç±»ä¼¼:
# inet 192.168.1.100 netmask 0xffffff00 broadcast 192.168.1.255
# ä½ çš„IPå°±æ˜¯: 192.168.1.100

# Linux
ip addr show | grep "inet " | grep -v 127.0.0.1

# Windows (CMD)
ipconfig | findstr "IPv4"
```

### 1.3 ä¸€é”®å¯åŠ¨è„šæœ¬

åˆ›å»º `start_dev.sh` (macOS/Linux):

```bash
#!/bin/bash
# ä¿å­˜åœ¨é¡¹ç›®æ ¹ç›®å½•

echo "=== QZÂ·TalentLens å¼€å‘ç¯å¢ƒå¯åŠ¨ ==="

# è·å–æœ¬æœºIP
LOCAL_IP=$(ifconfig | grep "inet " | grep -v 127.0.0.1 | head -n 1 | awk '{print $2}')
echo "ğŸ“ æœ¬æœºIP: $LOCAL_IP"

# å¯åŠ¨åç«¯ï¼ˆåå°è¿è¡Œï¼‰
echo "ğŸš€ å¯åŠ¨åç«¯æœåŠ¡..."
cd backend
source venv/bin/activate
nohup uvicorn app.main:app --reload --host 0.0.0.0 --port 9000 > ../logs/backend.log 2>&1 &
BACKEND_PID=$!
echo "âœ… åç«¯å·²å¯åŠ¨ (PID: $BACKEND_PID, ç«¯å£: 9000)"

# ç­‰å¾…åç«¯å¯åŠ¨
sleep 3

# å¯åŠ¨å‰ç«¯ï¼ˆå‰å°è¿è¡Œï¼‰
echo "ğŸš€ å¯åŠ¨å‰ç«¯æœåŠ¡..."
cd ../frontend
npm run dev

# Ctrl+C æ—¶åœæ­¢åç«¯
trap "kill $BACKEND_PID" EXIT
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
chmod +x start_dev.sh
./start_dev.sh
```

---

## äºŒã€å†…ç½‘æµ‹è¯•éƒ¨ç½²

### 2.1 å±€åŸŸç½‘å†…æµ‹è¯•ï¼ˆåŒä¸€WiFiï¼‰

**åœºæ™¯**: è®©åŠå…¬å®¤å†…çš„HRåŒäº‹ç”¨æ‰‹æœºæµ‹è¯•

#### æ­¥éª¤1: ç¡®ä¿é˜²ç«å¢™å¼€æ”¾ç«¯å£

```bash
# macOS: ç³»ç»Ÿåå¥½è®¾ç½® â†’ å®‰å…¨æ€§ä¸éšç§ â†’ é˜²ç«å¢™
# å…è®¸ Python å’Œ Node æ¥å—ä¼ å…¥è¿æ¥

# Linux (Ubuntu)
sudo ufw allow 9000
sudo ufw allow 5173
sudo ufw reload
```

#### æ­¥éª¤2: å¯åŠ¨æœåŠ¡ï¼ˆåŒä¸Šï¼‰

```bash
# åç«¯
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 9000

# å‰ç«¯
cd frontend
npm run dev
```

#### æ­¥éª¤3: HRåŒäº‹æ‰‹æœºè®¿é—®

```
1. ç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€WiFi
2. æ‰‹æœºæµè§ˆå™¨è®¿é—®: http://192.168.1.100:5173
   ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®é™…IPï¼‰
3. ç™»å½•è´¦å·: admin / admin123
4. å¼€å§‹æµ‹è¯•
```

### 2.2 æµ‹è¯„é“¾æ¥ç”Ÿæˆï¼ˆå±€åŸŸç½‘ï¼‰

**é‡è¦**: åœ¨æœ¬åœ°/å†…ç½‘æµ‹è¯•æ—¶ï¼Œæµ‹è¯„é“¾æ¥ä¼šè‡ªåŠ¨ä½¿ç”¨å½“å‰è®¿é—®åœ°å€ï¼

```
ç¤ºä¾‹åœºæ™¯:
1. HRåœ¨ç”µè„‘ä¸Šè®¿é—®: http://192.168.1.100:5173
2. HRåˆ›å»ºæµ‹è¯„ï¼Œç”Ÿæˆçš„é“¾æ¥æ˜¯: 
   http://192.168.1.100:5173/assessment/ABC123
3. äºŒç»´ç ä¹Ÿæ˜¯è¿™ä¸ªåœ°å€
4. HRç”¨æ‰‹æœºæ‰«ç ï¼Œå¯ä»¥ç›´æ¥æ‰“å¼€ï¼ˆåŒWiFiï¼‰

âœ… æ— éœ€ä¿®æ”¹ä»£ç ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰åŸŸåï¼
```

---

## ä¸‰ã€Ngrokå¤–ç½‘è®¿é—®

### 3.1 ä»€ä¹ˆæ˜¯Ngrokï¼Ÿ

**Ngrok** æ˜¯ä¸€ä¸ªå†…ç½‘ç©¿é€å·¥å…·ï¼Œå¯ä»¥è®©ä½ çš„æœ¬åœ°æœåŠ¡ä¸´æ—¶æš´éœ²åˆ°å…¬ç½‘ï¼Œè·å¾—ä¸€ä¸ªå…¬ç½‘åŸŸåã€‚

**ä½¿ç”¨åœºæ™¯**:
- âœ… è®©ä¸åœ¨åŒä¸€WiFiçš„HRåŒäº‹æµ‹è¯•ï¼ˆè¿œç¨‹ï¼‰
- âœ… è®©å€™é€‰äººåœ¨å®¶æ‰«ç ç­”é¢˜
- âœ… ä¸´æ—¶æ¼”ç¤ºç»™å®¢æˆ·çœ‹
- âœ… å¾®ä¿¡å†…æ‰“å¼€æµ‹è¯„é“¾æ¥ï¼ˆå¾®ä¿¡ä¸æ”¯æŒå±€åŸŸç½‘IPï¼‰

### 3.2 å®‰è£…Ngrok

#### macOS
```bash
# ä½¿ç”¨Homebrewå®‰è£…
brew install ngrok/ngrok/ngrok

# æˆ–æ‰‹åŠ¨ä¸‹è½½
# https://ngrok.com/download
```

#### Linux
```bash
# ä¸‹è½½å¹¶å®‰è£…
wget https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-linux-amd64.tgz
tar xvzf ngrok-v3-stable-linux-amd64.tgz
sudo mv ngrok /usr/local/bin/
```

#### Windows
```
ä¸‹è½½: https://ngrok.com/download
è§£å‹åˆ°ä»»æ„ç›®å½•ï¼Œæ·»åŠ åˆ°PATH
```

### 3.3 æ³¨å†ŒNgrokè´¦å·

```bash
# 1. è®¿é—® https://dashboard.ngrok.com/signup
# 2. æ³¨å†Œè´¦å·ï¼ˆå…è´¹ç‰ˆè¶³å¤Ÿç”¨ï¼‰
# 3. è·å– authtoken

# 4. é…ç½® authtoken
ngrok config add-authtoken YOUR_AUTH_TOKEN
```

### 3.4 å¯åŠ¨Ngrok

#### æ–¹å¼ä¸€: å•ç‹¬æš´éœ²åç«¯ï¼ˆæ¨èï¼‰

```bash
# ç»ˆç«¯1: å¯åŠ¨åç«¯
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 9000

# ç»ˆç«¯2: å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# ç»ˆç«¯3: å¯åŠ¨Ngrokï¼ˆæš´éœ²å‰ç«¯ï¼‰
ngrok http 5173

# ä½ ä¼šçœ‹åˆ°:
# Forwarding  https://abc123.ngrok.io -> http://localhost:5173
# è¿™ä¸ª https://abc123.ngrok.io å°±æ˜¯ä½ çš„ä¸´æ—¶å…¬ç½‘åŸŸåï¼
```

**é‡è¦**: è¿˜éœ€è¦é…ç½®å‰ç«¯çš„APIåœ°å€ï¼

#### æ–¹å¼äºŒ: åŒæ—¶æš´éœ²å‰åç«¯ï¼ˆéœ€è¦2ä¸ªNgrokè¿›ç¨‹ï¼‰

```bash
# ç»ˆç«¯1: å¯åŠ¨åç«¯
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 9000

# ç»ˆç«¯2: Ngrokæš´éœ²åç«¯
ngrok http 9000
# å¾—åˆ°: https://backend123.ngrok.io

# ç»ˆç«¯3: å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# ç»ˆç«¯4: Ngrokæš´éœ²å‰ç«¯
ngrok http 5173
# å¾—åˆ°: https://frontend456.ngrok.io
```

### 3.5 é…ç½®å‰ç«¯APIåœ°å€ï¼ˆä½¿ç”¨Ngrokæ—¶ï¼‰

**é‡è¦**: å‰ç«¯éœ€è¦çŸ¥é“åç«¯çš„Ngrokåœ°å€ï¼

#### ä¸´æ—¶ä¿®æ”¹ï¼ˆå¼€å‘æµ‹è¯•ï¼‰

ç¼–è¾‘ `frontend/src/api/index.ts`:

```typescript
// åŸå§‹ä»£ç ï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || '/api'

// Ngrokæµ‹è¯•æ—¶æ”¹ä¸º:
const API_BASE_URL = 'https://backend123.ngrok.io/api'  // ä½ çš„åç«¯Ngrokåœ°å€
```

**æˆ–è€…** ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆæ›´æ¨èï¼‰ï¼š

åˆ›å»º `frontend/.env.development.local`:
```bash
VITE_API_BASE_URL=https://backend123.ngrok.io/api
```

ç„¶åé‡å¯å‰ç«¯ï¼š
```bash
npm run dev
```

### 3.6 å®Œæ•´Ngrokæµ‹è¯•æµç¨‹

```bash
# 1. å¯åŠ¨åç«¯
cd backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 9000

# 2. å¯åŠ¨Ngrokæš´éœ²åç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
ngrok http 9000
# è®°å½•åœ°å€: https://abc123.ngrok.io

# 3. é…ç½®å‰ç«¯APIåœ°å€
cd frontend
echo "VITE_API_BASE_URL=https://abc123.ngrok.io/api" > .env.development.local

# 4. å¯åŠ¨å‰ç«¯
npm run dev

# 5. å¯åŠ¨Ngrokæš´éœ²å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
ngrok http 5173
# è®°å½•åœ°å€: https://def456.ngrok.io

# 6. è®¿é—®
# æµè§ˆå™¨æ‰“å¼€: https://def456.ngrok.io
# æ‰‹æœºæ‰«ç æµ‹è¯„: https://def456.ngrok.io/assessment/XXX
```

### 3.7 Ngrokæ³¨æ„äº‹é¡¹

âš ï¸ **å…è´¹ç‰ˆé™åˆ¶**:
- æ¯æ¬¡å¯åŠ¨åœ°å€éƒ½ä¼šå˜ï¼ˆå¦‚ `abc123.ngrok.io` â†’ `xyz789.ngrok.io`ï¼‰
- æ¯åˆ†é’Ÿ40ä¸ªè¯·æ±‚é™åˆ¶
- ä¼šæ˜¾ç¤ºNgrokæç¤ºé¡µé¢ï¼ˆç‚¹å‡»"Visit Site"ç»§ç»­ï¼‰

âœ… **é€‚ç”¨åœºæ™¯**:
- ä¸´æ—¶æµ‹è¯•ï¼ˆå‡ å°æ—¶ï¼‰
- å°è§„æ¨¡ä½¿ç”¨ï¼ˆ5-10äººï¼‰
- æ¼”ç¤ºDemo

âŒ **ä¸é€‚ç”¨åœºæ™¯**:
- é•¿æœŸä½¿ç”¨ï¼ˆåœ°å€ä¼šå˜ï¼‰
- å¤§é‡å¹¶å‘ï¼ˆæœ‰é™æµï¼‰
- ç”Ÿäº§ç¯å¢ƒ

ğŸ’¡ **æ›¿ä»£æ–¹æ¡ˆ**:
- **Ngrokä»˜è´¹ç‰ˆ**: å›ºå®šåŸŸå ($8/æœˆ)
- **èŠ±ç”Ÿå£³**: å›½å†…å†…ç½‘ç©¿é€å·¥å…·
- **FRP**: è‡ªå»ºå†…ç½‘ç©¿é€ï¼ˆéœ€è¦æœ‰å…¬ç½‘æœåŠ¡å™¨ï¼‰

---

## å››ã€åŸŸåé…ç½®è¯´æ˜

### 4.1 åŸŸåç”³è¯·å’Œè§£æ

#### æ­¥éª¤1: å‘å…¬å¸ç”³è¯·åŸŸå

```
ç¤ºä¾‹åŸŸå:
- hr.yourcompany.com
- talent.yourcompany.com
- recruit.yourcompany.com
```

#### æ­¥éª¤2: DNSè§£æé…ç½®

```
åœ¨å…¬å¸DNSç®¡ç†å¹³å°é…ç½®:
ç±»å‹: Aè®°å½•
ä¸»æœºè®°å½•: hr (æˆ–talent)
è®°å½•å€¼: ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP (å¦‚ 120.123.45.67)
TTL: 600

è§£æåçš„å®Œæ•´åŸŸå: hr.yourcompany.com
```

### 4.2 åŸŸåé…ç½®æ˜¯å¦éœ€è¦å†™å…¥ä»£ç ï¼Ÿ

**é‡è¦ç­”æ¡ˆ**: âŒ **ä¸éœ€è¦ï¼ç³»ç»Ÿå·²ç»åšäº†åŠ¨æ€é€‚é…ï¼**

#### ç³»ç»Ÿçš„æ™ºèƒ½æ£€æµ‹æœºåˆ¶

**å‰ç«¯ä»£ç **ï¼ˆ`frontend/src/api/index.ts`ï¼‰:
```typescript
// ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰è®¿é—®çš„åŸŸå
const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || '/api'

// è®¿é—® localhost:5173 â†’ APIåœ°å€: /api (ä»£ç†åˆ° localhost:9000)
// è®¿é—® hr.company.com â†’ APIåœ°å€: /api (ä»£ç†åˆ° hr.company.com/api)
// âœ… æ— éœ€ä¿®æ”¹ä»£ç ï¼
```

**åç«¯æµ‹è¯„é“¾æ¥ç”Ÿæˆ**ï¼ˆ`backend/app/api/assessments/router.py`ï¼‰:
```python
# ç³»ç»Ÿä¼šæ ¹æ®è¯·æ±‚çš„Hostå¤´è‡ªåŠ¨ç”Ÿæˆé“¾æ¥
def generate_assessment_link(request: Request, code: str) -> str:
    # è·å–å½“å‰è®¿é—®çš„åŸŸå
    host = request.headers.get("host")  # å¦‚: hr.company.com
    scheme = request.url.scheme  # http æˆ– https
    
    # è‡ªåŠ¨ç”Ÿæˆé“¾æ¥
    link = f"{scheme}://{host}/assessment/{code}"
    # âœ… åŸŸåå˜äº†ï¼Œé“¾æ¥è‡ªåŠ¨å˜ï¼æ— éœ€æ”¹ä»£ç ï¼
    return link
```

### 4.3 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²åçš„é…ç½®

#### Nginxé…ç½®ï¼ˆé‡è¦ï¼ï¼‰

```nginx
# /etc/nginx/sites-available/talentlens

server {
    listen 80;
    server_name hr.yourcompany.com;  # ä½ çš„åŸŸå

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /var/www/talentlens;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # åç«¯APIä»£ç†
    location /api {
        proxy_pass http://127.0.0.1:9000;
        proxy_set_header Host $host;  # â­ ä¼ é€’åŸŸåç»™åç«¯
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # æ–‡ä»¶ä¸Šä¼ é™åˆ¶
    client_max_body_size 50M;
}

# HTTPSé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…éœ€ï¼ï¼‰
server {
    listen 443 ssl;
    server_name hr.yourcompany.com;

    ssl_certificate /etc/nginx/ssl/cert.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;

    # å…¶ä»–é…ç½®åŒä¸Š...
}
```

### 4.4 åŸŸååˆ‡æ¢æ—¶éœ€è¦åšä»€ä¹ˆï¼Ÿ

**ç­”æ¡ˆ**: âœ… **åªéœ€è¦ä¿®æ”¹Nginxé…ç½®ï¼Œé‡å¯Nginxå³å¯ï¼**

```bash
# 1. ä¿®æ”¹Nginxé…ç½®ä¸­çš„ server_name
sudo nano /etc/nginx/sites-available/talentlens
# å°† server_name æ”¹ä¸ºæ–°åŸŸå

# 2. æµ‹è¯•é…ç½®
sudo nginx -t

# 3. é‡å¯Nginx
sudo systemctl restart nginx

# 4. è®¿é—®æ–°åŸŸå
# æµè§ˆå™¨: https://new-domain.com
# æµ‹è¯„é“¾æ¥ä¼šè‡ªåŠ¨ä½¿ç”¨æ–°åŸŸåï¼
```

**ä»£ç å±‚é¢**: âŒ **å®Œå…¨ä¸éœ€è¦ä¿®æ”¹ï¼**

---

## äº”ã€æµ‹è¯„é“¾æ¥å’ŒäºŒç»´ç 

### 5.1 æµ‹è¯„é“¾æ¥çš„ç”Ÿæˆæœºåˆ¶

#### åç«¯é€»è¾‘ï¼ˆè‡ªåŠ¨æ£€æµ‹åŸŸåï¼‰

```python
# backend/app/api/assessments/router.py

@router.post("/")
async def create_assessment(
    request: Request,  # â­ è‡ªåŠ¨æ³¨å…¥è¯·æ±‚å¯¹è±¡
    data: AssessmentCreate,
    session: Session = Depends(get_session)
):
    # 1. åˆ›å»ºæµ‹è¯„è®°å½•
    assessment = Assessment(...)
    session.add(assessment)
    session.commit()
    
    # 2. è‡ªåŠ¨ç”Ÿæˆé“¾æ¥ï¼ˆæ ¹æ®å½“å‰åŸŸåï¼‰
    host = request.headers.get("host")  # è·å–åŸŸå
    scheme = "https" if request.url.scheme == "https" else "http"
    
    link = f"{scheme}://{host}/assessment/{assessment.code}"
    # ç¤ºä¾‹ç»“æœ:
    # localhost: http://localhost:5173/assessment/ABC123
    # å†…ç½‘IP: http://192.168.1.100:5173/assessment/ABC123
    # Ngrok: https://abc123.ngrok.io/assessment/ABC123
    # æ­£å¼åŸŸå: https://hr.company.com/assessment/ABC123
    
    # 3. ç”ŸæˆäºŒç»´ç 
    qr_url = generate_qrcode(link)
    assessment.qr_code_url = qr_url
    
    return assessment
```

### 5.2 ä¸åŒåœºæ™¯ä¸‹çš„é“¾æ¥

| åœºæ™¯ | è®¿é—®åœ°å€ | ç”Ÿæˆçš„æµ‹è¯„é“¾æ¥ | æ˜¯å¦å¯ç”¨ |
|------|---------|--------------|---------|
| æœ¬åœ°å¼€å‘ | localhost:5173 | http://localhost:5173/assessment/ABC123 | âœ… æœ¬æœºå¯ç”¨ |
| å±€åŸŸç½‘æµ‹è¯• | 192.168.1.100:5173 | http://192.168.1.100:5173/assessment/ABC123 | âœ… åŒWiFiå¯ç”¨ |
| Ngrokä¸´æ—¶ | https://abc.ngrok.io | https://abc.ngrok.io/assessment/ABC123 | âœ… å…¬ç½‘å¯ç”¨ï¼ˆä¸´æ—¶ï¼‰|
| æ­£å¼åŸŸå | https://hr.company.com | https://hr.company.com/assessment/ABC123 | âœ… å…¬ç½‘å¯ç”¨ï¼ˆæ°¸ä¹…ï¼‰|

### 5.3 æ˜¯å¦éœ€è¦æ­£å¼åŸŸåï¼Ÿ

#### å„åœºæ™¯å¯¹æ¯”

| éœ€æ±‚ | æ˜¯å¦éœ€è¦åŸŸå | æ¨èæ–¹æ¡ˆ |
|------|------------|---------|
| æœ¬åœ°å¼€å‘æµ‹è¯• | âŒ ä¸éœ€è¦ | localhost |
| åŠå…¬å®¤å†…æµ‹è¯• | âŒ ä¸éœ€è¦ | å±€åŸŸç½‘IP |
| è¿œç¨‹HRæµ‹è¯• | âš ï¸ å»ºè®®æœ‰ | Ngrokä¸´æ—¶åŸŸå |
| å€™é€‰äººç­”é¢˜ï¼ˆæ‰‹æœºï¼‰ | âš ï¸ å»ºè®®æœ‰ | Ngrokæˆ–æ­£å¼åŸŸå |
| å¾®ä¿¡å†…æ‰“å¼€ | âœ… **å¿…é¡»** | æ­£å¼åŸŸåï¼ˆéœ€å¤‡æ¡ˆï¼‰|
| ç”Ÿäº§ç¯å¢ƒ | âœ… **å¿…é¡»** | æ­£å¼åŸŸå |

#### ä¸ºä»€ä¹ˆå¾®ä¿¡éœ€è¦æ­£å¼åŸŸåï¼Ÿ

```
å¾®ä¿¡é™åˆ¶:
- âŒ ä¸èƒ½æ‰“å¼€ localhost
- âŒ ä¸èƒ½æ‰“å¼€å±€åŸŸç½‘IP (192.168.x.x)
- âš ï¸ NgrokåŸŸåä¼šæ˜¾ç¤º"æœªéªŒè¯çš„ç½‘é¡µ"è­¦å‘Š
- âœ… åªæœ‰å¤‡æ¡ˆçš„æ­£å¼åŸŸåå¯ä»¥æ­£å¸¸æ‰“å¼€
```

### 5.4 æµ‹è¯•é˜¶æ®µçš„æœ€ä½³å®è·µ

#### é˜¶æ®µ1: å†…éƒ¨æµ‹è¯•ï¼ˆHRåŒäº‹ï¼‰

```bash
# ä½¿ç”¨å±€åŸŸç½‘IP
åç«¯: http://192.168.1.100:9000
å‰ç«¯: http://192.168.1.100:5173

ä¼˜ç‚¹:
âœ… å…è´¹ï¼Œç¨³å®š
âœ… é€Ÿåº¦å¿«ï¼ˆå±€åŸŸç½‘ï¼‰
âœ… æ— éœ€é…ç½®

ç¼ºç‚¹:
âŒ åªèƒ½åŒWiFiè®¿é—®
âŒ æ‰‹æœºéœ€è¦è¿å…¬å¸WiFi
```

#### é˜¶æ®µ2: å°èŒƒå›´å¤–éƒ¨æµ‹è¯•ï¼ˆ5-10ä¸ªå€™é€‰äººï¼‰

```bash
# ä½¿ç”¨Ngrok
å‰ç«¯: https://abc123.ngrok.io
åç«¯: https://def456.ngrok.io

ä¼˜ç‚¹:
âœ… å…¬ç½‘è®¿é—®
âœ… æ”¯æŒHTTPS
âœ… å¿«é€Ÿéƒ¨ç½²

ç¼ºç‚¹:
âš ï¸ åœ°å€ä¼šå˜ï¼ˆæ¯æ¬¡é‡å¯ï¼‰
âš ï¸ æœ‰è¯·æ±‚é™åˆ¶ï¼ˆå…è´¹ç‰ˆï¼‰
âš ï¸ å¾®ä¿¡ä¼šæç¤º"æœªéªŒè¯"
```

#### é˜¶æ®µ3: æ­£å¼ä½¿ç”¨

```bash
# ä½¿ç”¨æ­£å¼åŸŸå
å‰ç«¯: https://hr.company.com

ä¼˜ç‚¹:
âœ… å›ºå®šåœ°å€
âœ… å¾®ä¿¡æ­£å¸¸æ‰“å¼€
âœ… æ— é™åˆ¶
âœ… ä¸“ä¸šå½¢è±¡

ç¼ºç‚¹:
âš ï¸ éœ€è¦ç”³è¯·åŸŸå
âš ï¸ éœ€è¦å¤‡æ¡ˆï¼ˆå›½å†…ï¼‰
âš ï¸ éœ€è¦SSLè¯ä¹¦
```

---

## å…­ã€å¸¸è§é—®é¢˜

### Q1: æ‰‹æœºæ‰«ç åæ˜¾ç¤º"æ— æ³•è®¿é—®"

**åŸå› **: æ‰‹æœºå’Œç”µè„‘ä¸åœ¨åŒä¸€WiFi

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆ1: æ‰‹æœºè¿æ¥åŒä¸€WiFi
# ç¡®ä¿æ‰‹æœºè¿æ¥å…¬å¸WiFiï¼Œä¸è¦ç”¨4G/5G

# æ–¹æ¡ˆ2: ä½¿ç”¨Ngrok
ngrok http 5173
# ç”¨Ngrokåœ°å€ç”ŸæˆäºŒç»´ç 
```

### Q2: å¾®ä¿¡æ‰«ç æ˜¾ç¤º"æœªéªŒè¯çš„ç½‘é¡µ"

**åŸå› **: å¾®ä¿¡åªä¿¡ä»»å¤‡æ¡ˆåŸŸå

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä¸´æ—¶æ–¹æ¡ˆ: ç‚¹å‡»"ç»§ç»­è®¿é—®"ï¼ˆå¯ä»¥ç”¨ï¼Œä½†ä¸ä¸“ä¸šï¼‰

# æ­£å¼æ–¹æ¡ˆ: ç”³è¯·å…¬å¸åŸŸåå¹¶å¤‡æ¡ˆ
# 1. å‘ITéƒ¨é—¨ç”³è¯·åŸŸå
# 2. å®ŒæˆICPå¤‡æ¡ˆ
# 3. é…ç½®åˆ°ç”Ÿäº§æœåŠ¡å™¨
```

### Q3: å±€åŸŸç½‘IPåœ°å€ä¼šå˜æ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆ1: å›ºå®šæœ¬æœºIPï¼ˆæ¨èï¼‰
# macOS: ç³»ç»Ÿåå¥½è®¾ç½® â†’ ç½‘ç»œ â†’ é«˜çº§ â†’ TCP/IP
# é€‰æ‹©"ä½¿ç”¨DHCPï¼ˆæ‰‹åŠ¨åœ°å€ï¼‰"ï¼Œè¾“å…¥å›ºå®šIPå¦‚ 192.168.1.100

# æ–¹æ¡ˆ2: æ¯æ¬¡å¯åŠ¨æ—¶æŸ¥çœ‹IP
ifconfig | grep "inet " | grep -v 127.0.0.1
# å‘Šè¯‰HRæ–°çš„IPåœ°å€
```

### Q4: Ngrokåœ°å€æ¯æ¬¡éƒ½å˜æ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆ1: ä½¿ç”¨Ngrokä»˜è´¹ç‰ˆï¼ˆ$8/æœˆï¼‰
# å¯ä»¥è·å¾—å›ºå®šåŸŸåï¼Œå¦‚ yourname.ngrok.io

# æ–¹æ¡ˆ2: å°½å¿«ç”³è¯·æ­£å¼åŸŸå
# ä¸´æ—¶æµ‹è¯•å®Œå°±éƒ¨ç½²åˆ°æ­£å¼æœåŠ¡å™¨

# æ–¹æ¡ˆ3: ä½¿ç”¨å…¶ä»–å·¥å…·
# - èŠ±ç”Ÿå£³ï¼ˆå›½å†…ï¼‰
# - FRPï¼ˆè‡ªå»ºï¼Œéœ€è¦å…¬ç½‘æœåŠ¡å™¨ï¼‰
```

### Q5: å‰ç«¯è°ƒç”¨åç«¯APIå¤±è´¥ï¼ˆè·¨åŸŸé”™è¯¯ï¼‰

**ç—‡çŠ¶**: æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º `CORS error`

**è§£å†³æ–¹æ¡ˆ**:
```python
# åç«¯å·²ç»é…ç½®äº†CORSï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«ä½ çš„åŸŸå
# backend/app/main.py

app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "http://localhost:5173",
        "http://192.168.1.100:5173",  # æ·»åŠ ä½ çš„å±€åŸŸç½‘IP
        "https://*.ngrok.io",  # å…è®¸æ‰€æœ‰NgrokåŸŸå
        "https://hr.yourcompany.com",  # æ·»åŠ æ­£å¼åŸŸå
    ],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### Q6: éƒ¨ç½²åˆ°æœåŠ¡å™¨åï¼Œæµ‹è¯„é“¾æ¥è¿˜æ˜¯localhost

**åŸå› **: Nginxæ²¡æœ‰æ­£ç¡®ä¼ é€’Hostå¤´

**è§£å†³æ–¹æ¡ˆ**:
```nginx
# æ£€æŸ¥Nginxé…ç½®ä¸­æ˜¯å¦æœ‰:
proxy_set_header Host $host;  # â­ å¿…é¡»æœ‰è¿™è¡Œï¼

# å®Œæ•´é…ç½®:
location /api {
    proxy_pass http://127.0.0.1:9000;
    proxy_set_header Host $host;  # â­â­â­
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# ä¿®æ”¹åé‡å¯Nginx
sudo nginx -t
sudo systemctl restart nginx
```

---

## ä¸ƒã€å¿«é€Ÿå‚è€ƒ

### 7.1 æœ¬åœ°å¼€å‘å¯åŠ¨å‘½ä»¤

```bash
# åç«¯
cd backend && uvicorn app.main:app --reload --host 0.0.0.0 --port 9000

# å‰ç«¯
cd frontend && npm run dev
```

### 7.2 Ngrokå¿«é€Ÿå¯åŠ¨

```bash
# 1. å¯åŠ¨æœåŠ¡
# åç«¯: uvicorn app.main:app --reload --host 0.0.0.0 --port 9000
# å‰ç«¯: npm run dev

# 2. æš´éœ²å‰ç«¯
ngrok http 5173

# 3. é…ç½®åç«¯Ngrokåœ°å€ï¼ˆå¦‚æœéœ€è¦ï¼‰
# ç¼–è¾‘ frontend/.env.development.local
# VITE_API_BASE_URL=https://ä½ çš„åç«¯ngrokåœ°å€/api
```

### 7.3 æŸ¥çœ‹æœ¬æœºIP

```bash
# macOS/Linux
ifconfig | grep "inet " | grep -v 127.0.0.1 | awk '{print $2}'

# æˆ–
hostname -I
```

### 7.4 æµ‹è¯•é“¾æ¥æ˜¯å¦å¯è®¿é—®

```bash
# æµ‹è¯•åç«¯
curl http://localhost:9000/docs

# æµ‹è¯•å‰ç«¯
curl http://localhost:5173

# æµ‹è¯•å±€åŸŸç½‘è®¿é—®
curl http://192.168.1.100:9000/docs
```

---

## å…«ã€æ¨èçš„æµ‹è¯•æµç¨‹

### ç»™HRäººå‘˜æµ‹è¯•çš„æ ‡å‡†æµç¨‹

#### é˜¶æ®µ1: åŠå…¬å®¤å†…æµ‹è¯•ï¼ˆ1-2å¤©ï¼‰

```bash
1. å¼€å‘äººå‘˜å¯åŠ¨æœ¬åœ°æœåŠ¡
   - åç«¯: 0.0.0.0:9000
   - å‰ç«¯: å±€åŸŸç½‘IP:5173

2. HRåŒäº‹æ‰‹æœºè¿æ¥å…¬å¸WiFi

3. HRè®¿é—®: http://192.168.1.100:5173
   ï¼ˆæ›¿æ¢ä¸ºå®é™…IPï¼‰

4. HRåˆ›å»ºæµ‹è¯„ï¼Œç”ŸæˆäºŒç»´ç 

5. HRç”¨è‡ªå·±æ‰‹æœºæ‰«ç æµ‹è¯•ç­”é¢˜

6. æ”¶é›†åé¦ˆï¼Œä¿®å¤Bug
```

#### é˜¶æ®µ2: è¿œç¨‹æµ‹è¯•ï¼ˆ3-5å¤©ï¼‰

```bash
1. å¼€å‘äººå‘˜å¯åŠ¨Ngrok
   ngrok http 5173

2. è·å¾—å…¬ç½‘åœ°å€: https://abc123.ngrok.io

3. å‘é€ç»™HRäººå‘˜

4. HRåœ¨ä»»ä½•åœ°æ–¹è®¿é—®
   - ç”µè„‘æµè§ˆå™¨æ‰“å¼€
   - æ‰‹æœºæ‰«ç ç­”é¢˜
   - å¾®ä¿¡åˆ†äº«æµ‹è¯„é“¾æ¥

5. æ”¶é›†åé¦ˆï¼Œä¼˜åŒ–åŠŸèƒ½
```

#### é˜¶æ®µ3: æ­£å¼éƒ¨ç½²ï¼ˆç”³è¯·åŸŸååï¼‰

```bash
1. å‘å…¬å¸ITç”³è¯·åŸŸå
   - å¦‚: hr.company.com

2. è¿ç»´äººå‘˜éƒ¨ç½²åˆ°æœåŠ¡å™¨
   - é…ç½®Nginx
   - é…ç½®SSLè¯ä¹¦
   - å¯åŠ¨æœåŠ¡

3. HRè®¿é—®æ­£å¼åŸŸåæµ‹è¯•

4. ç¡®è®¤æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

5. æ­£å¼æŠ•å…¥ä½¿ç”¨
```

---

## é™„å½•

### A. ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®äº¤ä»˜æŒ‡å—](./é¡¹ç›®äº¤ä»˜æŒ‡å—.md)
- [éƒ¨ç½²äº¤ä»˜æ–‡æ¡£](./04_éƒ¨ç½²äº¤ä»˜æ–‡æ¡£.md)
- [åç»­ç»´æŠ¤æ–‡æ¡£](./05_åç»­ç»´æŠ¤æ–‡æ¡£.md)

### B. å¤–éƒ¨èµ„æº

- Ngrokå®˜ç½‘: https://ngrok.com
- Ngrokæ–‡æ¡£: https://ngrok.com/docs
- èŠ±ç”Ÿå£³: https://hsk.oray.com
- FRP: https://github.com/fatedier/frp

### C. æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥é˜…æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚

