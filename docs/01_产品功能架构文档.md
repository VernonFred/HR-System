# QZ·TalentLens 产品功能架构文档

> **版本**: v1.0  
> **更新日期**: 2025年12月8日  
> **系统名称**: QZ·TalentLens - 人员初步画像智能工具

---

## 一、产品概述

### 1.1 产品定位

QZ·TalentLens 是一款专业的人员画像智能分析系统，旨在帮助企业 HR 部门快速、准确地了解候选人和员工的能力特征、性格特点和职业倾向。系统通过专业测评（MBTI、DISC、EPQ）和自定义问卷调查，结合 AI 智能分析，生成多维度的人员画像报告。

### 1.2 核心价值

| 价值点 | 描述 |
|--------|------|
| **智能画像** | 基于多维度测评数据，AI 自动生成人员综合画像 |
| **专业测评** | 内置 MBTI、DISC、EPQ 三大国际标准人格测评 |
| **灵活问卷** | 支持自定义问卷，满足企业个性化调研需求 |
| **岗位匹配** | 配置岗位能力画像，智能匹配候选人 |
| **数据驱动** | 可视化统计分析，支持数据导出 |

### 1.3 目标用户

- **HR 管理人员**: 招聘、员工发展、人才盘点
- **部门主管**: 了解团队成员特点，优化团队配置
- **企业管理层**: 人才战略决策支持

---

## 二、系统架构

### 2.1 技术架构

```
┌─────────────────────────────────────────────────────────────┐
│                        前端 (Frontend)                        │
│  Vue 3 + TypeScript + Vite + Pinia + Vue Router + ECharts    │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        后端 (Backend)                         │
│         FastAPI + SQLModel + Pydantic + JWT Auth             │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                       AI 服务层                               │
│    ModelScope API (Qwen) + 智能降级 + 多模型路由              │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        数据层                                 │
│                   SQLite (开发) / PostgreSQL (生产)           │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 模块架构

```
QZ·TalentLens
├── 画像中心
│   ├── 人员画像 (CandidatesPage)
│   ├── 岗位画像配置 (JobProfilesPage)
│   └── 专业测评 (ProfessionalAssessment)
├── 问卷中心 (QuestionnaireCenter)
│   ├── 问卷库
│   ├── 提交记录
│   └── 问卷统计
├── 人员管理 (UserManagementPage)
└── 系统设置 (SettingsPage)
```

---

## 三、功能模块详解

### 3.1 人员画像模块

#### 3.1.1 功能概述

人员画像是系统的核心展示模块，汇聚候选人/员工的所有测评数据，生成综合画像报告。

#### 3.1.2 功能清单

| 功能 | 描述 | 数据来源 |
|------|------|----------|
| 候选人列表 | 展示所有参与测评的人员 | candidates 表 |
| 基础信息卡片 | 姓名、电话、岗位、测评次数 | candidates 表 |
| 专业测评画像 | MBTI/DISC/EPQ 测评结果可视化 | submission 表 (专业测评) |
| 问卷数据展示 | 自定义问卷的填写数据 | submission 表 (问卷调查) |
| AI 综合分析 | 基于所有数据的 AI 智能分析 | AI 服务实时生成 |
| 雷达图展示 | 多维度能力雷达图 | 计算得分 |

#### 3.1.3 数据流

```
用户填写测评 → 提交答案 → 计算得分 → 存储 submission
                                          ↓
管理员查看 ← AI 生成画像 ← 聚合数据 ← 查询 candidates
```

#### 3.1.4 AI 画像生成逻辑

1. **数据收集**: 获取候选人所有测评提交记录
2. **维度分析**: 
   - MBTI: 16 种人格类型
   - DISC: D/I/S/C 四种行为风格
   - EPQ: E/N/P/L 四个人格维度
3. **综合评估**: AI 整合多维度数据生成综合分析
4. **报告输出**: 结构化画像报告 + 发展建议

---

### 3.2 岗位画像配置模块

#### 3.2.1 功能概述

定义岗位的能力要求和权重，用于人岗匹配分析。

#### 3.2.2 功能清单

| 功能 | 描述 |
|------|------|
| 创建岗位画像 | 手动配置岗位名称、部门、能力维度 |
| 能力维度配置 | 设置各维度名称、权重（总和100%）、描述 |
| AI 辅助配置 | 一键 AI 生成能力维度建议 |
| 导入简历分析 | 上传优秀员工简历，AI 提取岗位特征 |
| 导入 JD 分析 | 输入岗位 JD，AI 解析能力要求 |
| 人岗匹配 | 计算候选人与岗位的匹配度 |

#### 3.2.3 AI 辅助功能

```
┌─────────────────────────────────────────────────────┐
│                  AI 辅助配置流程                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────┐ │
│  │  导入简历   │    │  导入 JD    │    │ AI配置  │ │
│  │  (PDF/Word) │    │  (文本)     │    │ (岗位名)│ │
│  └──────┬──────┘    └──────┬──────┘    └────┬────┘ │
│         │                  │                │      │
│         ▼                  ▼                ▼      │
│  ┌─────────────────────────────────────────────┐   │
│  │              AI 分析引擎                     │   │
│  │  - 提取关键技能                              │   │
│  │  - 识别能力要求                              │   │
│  │  - 生成维度建议                              │   │
│  │  - 智能分配权重                              │   │
│  └─────────────────────────────────────────────┘   │
│                        │                           │
│                        ▼                           │
│  ┌─────────────────────────────────────────────┐   │
│  │           岗位画像配置建议                    │   │
│  │  - 能力维度列表                              │   │
│  │  - 各维度权重                                │   │
│  │  - 维度描述说明                              │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

### 3.3 专业测评模块

#### 3.3.1 功能概述

管理专业人格测评（MBTI、DISC、EPQ），包括测评分发、答题、结果分析。

#### 3.3.2 测评类型

| 测评 | 题目数 | 时长 | 维度 | 结果类型 |
|------|--------|------|------|----------|
| MBTI | 93题 | 15分钟 | E/I, S/N, T/F, J/P | 16种人格类型 |
| DISC | 28题 | 8分钟 | D, I, S, C | 行为风格组合 |
| EPQ | 48题 | 5分钟 | E, N, P, L | 人格特质得分 |

#### 3.3.3 功能清单

| 功能 | 描述 |
|------|------|
| 测评管理 | 查看/启用/禁用测评 |
| 生成链接 | 生成测评访问链接和二维码 |
| 分发配置 | 设置有效期、表单字段、页面文案 |
| 提交记录 | 查看所有提交，支持列表/分组视图 |
| 结果详情 | 查看单个提交的详细结果 |
| 批量删除 | 批量删除提交记录 |
| 数据导出 | 导出提交数据为 Excel |

#### 3.3.4 候选人端流程

```
1. 扫码/点击链接 → 2. 填写基本信息 → 3. 开始答题 → 4. 提交答案 → 5. 查看结果
```

---

### 3.4 问卷中心模块

#### 3.4.1 功能概述

管理自定义问卷调查，支持评分类和调查类问卷。

#### 3.4.2 问卷类型

| 类型 | 特点 | 适用场景 |
|------|------|----------|
| 评分类 (scored) | 有分值计算，生成得分报告 | 能力评估、技能测评 |
| 调查类 (survey) | 无分值，收集意见数据 | 满意度调查、意见收集 |

#### 3.4.3 功能清单

| 功能 | 描述 |
|------|------|
| 问卷库 | 管理所有自定义问卷 |
| 创建问卷 | 可视化问卷编辑器 |
| 导入问卷 | 支持 JSON/Excel/Word 导入 |
| 题型支持 | 单选、多选、填空、评分、是非等 |
| 实时预览 | 编辑时实时预览问卷效果 |
| 分发链接 | 生成问卷访问链接 |
| 提交记录 | 查看问卷提交数据 |
| 问卷统计 | 数据可视化分析 |

#### 3.4.4 问卷编辑器

```
┌─────────────────────────────────────────────────────────────┐
│                      问卷编辑器                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────────────┐  ┌─────────────┐ │
│  │   控件库     │  │      编辑区域        │  │  实时预览   │ │
│  ├─────────────┤  ├─────────────────────┤  ├─────────────┤ │
│  │ □ 单选题    │  │  问卷标题            │  │ [预览效果]  │ │
│  │ □ 多选题    │  │  ─────────────       │  │             │ │
│  │ □ 填空题    │  │  题目1: ___          │  │  题目1      │ │
│  │ □ 评分题    │  │  选项配置...         │  │  ○ A        │ │
│  │ □ 是非题    │  │  ─────────────       │  │  ○ B        │ │
│  │ □ 二选一    │  │  题目2: ___          │  │  ○ C        │ │
│  │ □ 矩阵题    │  │  ...                 │  │             │ │
│  └─────────────┘  └─────────────────────┘  └─────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

### 3.5 人员管理模块

#### 3.5.1 功能概述

统一管理所有参与测评的人员信息，提供数据统计和管理功能。

#### 3.5.2 功能清单

| 功能 | 描述 |
|------|------|
| 人员列表 | 展示所有人员，支持搜索筛选 |
| 列表/分组视图 | 两种展示模式切换 |
| 统计指标 | 人员总数、待测评、已完成、测评记录数 |
| 单个删除 | 删除单个人员及相关数据 |
| 批量删除 | 批量删除选中人员 |
| 数据导出 | 导出人员数据为 Excel |

#### 3.5.3 数据聚合逻辑

```
人员管理数据 = 候选人表 (candidates) + 提交记录表 (submission)

聚合字段:
- 姓名、电话、岗位 → candidates 表
- 测评次数、完成率、最近测评 → submission 表聚合计算
```

---

### 3.6 系统设置模块

#### 3.6.1 功能概述

管理系统配置和用户账户安全。

#### 3.6.2 功能清单

| 功能 | 描述 |
|------|------|
| 修改密码 | 更新登录密码 |
| 修改用户名 | 更新管理员显示名称 |
| AI Token 配置 | 更新 ModelScope API Token |
| Token 状态监控 | 查看 Token 有效期和状态 |
| 关于系统 | 查看系统版本和技术信息 |

#### 3.6.3 Token 过期提醒

- Token 有效期：30天
- 提醒时机：到期前 7 天
- 提醒方式：每日登录时弹窗提醒
- 更新方式：在系统设置页面直接更新

---

## 四、数据流架构

### 4.1 核心数据流

```
┌─────────────────────────────────────────────────────────────────┐
│                         数据流向图                               │
└─────────────────────────────────────────────────────────────────┘

                    ┌─────────────────┐
                    │   候选人端      │
                    │  (公开访问)     │
                    └────────┬────────┘
                             │
                    ① 填写测评/问卷
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                        后端 API                                  │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ 创建提交记录 │→│  计算得分   │→│  存储结果   │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
└─────────────────────────────────────────────────────────────────┘
                             │
                    ② 数据入库
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                        数据库                                    │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ candidates  │  │ submission  │  │questionnaire│             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
└─────────────────────────────────────────────────────────────────┘
                             │
                    ③ 数据查询
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                       管理后台                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │  人员画像   │  │  提交记录   │  │  统计分析   │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
└─────────────────────────────────────────────────────────────────┘
                             │
                    ④ AI 分析请求
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────┐
│                       AI 服务                                    │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ 画像生成    │  │ 岗位分析   │  │ 简历解析   │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 人员数据同步逻辑

```
提交测评时:
1. 检查 candidates 表是否存在该手机号
2. 不存在 → 创建新候选人记录
3. 存在 → 更新候选人信息（姓名、岗位等）
4. 创建 submission 记录，关联 candidate_id

查询人员时:
- 人员画像: 查询 candidates 表 + 关联 submission
- 人员管理: 聚合 candidates + submission 统计数据
```

---

## 五、权限与安全

### 5.1 认证机制

- **认证方式**: JWT Token
- **Token 类型**: Access Token + Refresh Token
- **有效期**: Access Token 24小时，Refresh Token 7天
- **刷新机制**: 自动刷新，无感续期

### 5.2 路由权限

| 路由类型 | 认证要求 | 示例 |
|----------|----------|------|
| 公开路由 | 无需认证 | `/api/public/assessment/*` |
| 管理路由 | 需要认证 | `/api/candidates`, `/api/assessments` |
| 设置路由 | 需要管理员 | `/api/settings/*`, `/api/auth/*` |

### 5.3 数据安全

- 密码存储：bcrypt 哈希加密
- API Token：存储在 `.env` 文件，不入库
- 敏感数据：不记录在日志中

---

## 六、扩展性设计

### 6.1 测评类型扩展

系统支持添加新的专业测评类型：

1. 在 `preset-questions.ts` 添加题目数据
2. 在 `scoring_rules.py` 添加计分规则
3. 在前端添加结果展示组件

### 6.2 问卷题型扩展

支持的题型可通过配置扩展：

```typescript
// frontend/src/data/question-types.ts
export const QUESTION_TYPES = [
  { type: 'single', name: '单选题' },
  { type: 'multiple', name: '多选题' },
  { type: 'text', name: '填空题' },
  { type: 'rating', name: '评分题' },
  // 可添加更多题型...
];
```

### 6.3 AI 模型扩展

AI 服务层支持多模型路由和降级：

```python
# 模型优先级
1. qwen-plus (首选)
2. qwen-turbo (备选)
3. 本地规则 (降级)
```

---

## 七、性能优化

### 7.1 前端优化

- **代码分割**: 路由级别懒加载
- **组件异步**: 弹窗组件异步加载
- **图表优化**: ECharts 按需引入
- **缓存策略**: Pinia 状态持久化

### 7.2 后端优化

- **数据库索引**: 关键字段建立索引
- **分页查询**: 所有列表接口支持分页
- **连接池**: 数据库连接池管理
- **缓存**: 热点数据内存缓存

---

## 八、附录

### 8.1 技术栈版本

| 技术 | 版本 |
|------|------|
| Vue | 3.4+ |
| TypeScript | 5.0+ |
| Vite | 5.0+ |
| FastAPI | 0.100+ |
| Python | 3.11+ |
| SQLite | 3.x |

### 8.2 相关文档

- [产品使用指南](./02_产品使用指南.md)
- [大模型架构文档](./03_大模型架构文档.md)
- [部署交付文档](./04_部署交付文档.md)
- [API 接口文档](./06_API接口文档.md)
- [数据库表文档](./07_数据库表文档.md)

