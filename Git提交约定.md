# Git 提交约定文档

> **重要承诺**: 每次完成重要修改后，必须提交到GitHub保存  
> **版本**: v1.0  
> **生效日期**: 2025年12月11日

---

## 📋 目录

1. [提交原则](#一提交原则)
2. [必须提交的场景](#二必须提交的场景)
3. [提交流程](#三提交流程)
4. [提交信息规范](#四提交信息规范)
5. [快速提交命令](#五快速提交命令)
6. [提交检查清单](#六提交检查清单)

---

## 一、提交原则

### 🎯 核心原则

1. **及时提交**: 完成重要功能后立即提交，不拖延
2. **小步快跑**: 每个功能点完成就提交，不要积累太多改动
3. **描述清晰**: 提交信息要说明做了什么、为什么做
4. **保护隐私**: 确保敏感信息不被提交

### ⏰ 提交时机

**必须立即提交**:
- ✅ 完成一个完整功能
- ✅ 修复重要Bug
- ✅ 添加新文档
- ✅ 完成每日工作

**可以延后提交**:
- 🟡 临时调试代码
- 🟡 实验性代码
- 🟡 未完成的功能

---

## 二、必须提交的场景

### 🚀 Phase 1: 人员画像UI改造

#### Step 1: 创建新组件 ✅ 必须提交

**完成标志**:
- 创建 `AnalysisLevelSwitcher.vue`
- 创建 `CrossAnalysisBadge.vue`
- 组件可正常编译

**提交信息**:
```bash
git commit -m "feat(phase1): 添加分析级别切换器和交叉分析标识组件

- 新增 AnalysisLevelSwitcher.vue (支持3个分析级别)
- 新增 CrossAnalysisBadge.vue (显示交叉分析标识)
- 添加相关类型定义
- 符合设计规范的样式实现"
```

#### Step 2: 修改现有组件 ✅ 必须提交

**完成标志**:
- `AssessmentAccordion.vue` 添加交叉分析标识
- `CandidatesPage.vue` 集成新组件
- 功能测试通过

**提交信息**:
```bash
git commit -m "feat(phase1): 人员画像页面集成新UI组件

- AssessmentAccordion: 添加交叉分析标识显示
- CandidatesPage: 添加顶部功能栏和分析级别切换
- 优化测评记录卡片样式
- 添加相关状态管理逻辑

测试: 单测评和多测评场景均正常"
```

#### Step 3: 测试通过 ✅ 必须提交

**完成标志**:
- 所有功能测试通过
- 样式符合设计规范
- 无明显Bug

**提交信息**:
```bash
git commit -m "test(phase1): 完成人员画像UI改造测试

测试场景:
- ✅ 单一测评候选人
- ✅ 多测评候选人
- ✅ 分析级别切换
- ✅ 交叉分析标识显示
- ✅ 现有功能不受影响

Phase 1 UI改造完成"
```

---

### 🐛 Bug修复 ✅ 立即提交

**场景**: 发现并修复任何Bug

**提交信息模板**:
```bash
git commit -m "fix: 修复[具体问题]

问题描述: [详细说明问题]
修复方案: [说明如何修复]
影响范围: [说明影响哪些功能]"
```

**示例**:
```bash
git commit -m "fix: 修复EPQ图标导出时不显示的问题

问题描述: 使用dom-to-image-more导出时EPQ中心图标不显示
修复方案: 调整图标渲染方式，使用SVG内联
影响范围: 仅影响EPQ画像导出功能"
```

---

### 📝 文档更新 ✅ 必须提交

**场景**: 添加或更新文档

**提交信息**:
```bash
git commit -m "docs: 更新[文档名称]

更新内容:
- [具体更新1]
- [具体更新2]"
```

---

### 🎨 样式优化 🟡 可批量提交

**场景**: 纯样式调整，不影响功能

**提交信息**:
```bash
git commit -m "style: 优化[组件/页面]样式

- [具体优化1]
- [具体优化2]"
```

---

### ♻️ 代码重构 ✅ 重要时提交

**场景**: 重构代码但功能不变

**提交信息**:
```bash
git commit -m "refactor: 重构[模块/组件]

重构内容:
- [具体重构1]
- [具体重构2]

功能验证: ✅ 功能保持不变"
```

---

## 三、提交流程

### 🔄 标准提交流程（每次必须遵守）

```bash
# 1. 查看当前状态
cd /Users/Python项目/HR人事
git status

# 2. 查看具体改动（可选，建议查看）
git diff

# 3. 添加改动文件
git add [文件路径]
# 或添加所有改动（谨慎使用）
git add .

# 4. 提交（使用规范的提交信息）
git commit -m "类型: 简短描述

详细说明:
- 改动1
- 改动2"

# 5. 推送到远程
git push origin master

# 6. 确认推送成功
git log --oneline -1
```

---

### ⚡ 快速提交流程（简单改动）

使用自动化脚本:

```bash
cd /Users/Python项目/HR人事
./git-commit.sh
```

脚本会自动:
1. 检查Git状态
2. 清理旧文件
3. 添加核心代码
4. 显示待提交内容
5. 等待确认后提交并推送

---

## 四、提交信息规范

### 📝 提交类型（必须遵守）

| 类型 | 说明 | 示例 |
|------|------|------|
| `feat` | 新功能 | `feat(phase1): 添加分析级别切换器` |
| `fix` | Bug修复 | `fix: 修复画像导出样式问题` |
| `docs` | 文档更新 | `docs: 更新API文档` |
| `style` | 样式调整 | `style: 优化按钮间距` |
| `refactor` | 代码重构 | `refactor: 优化API调用逻辑` |
| `test` | 测试相关 | `test: 添加单元测试` |
| `chore` | 构建/工具 | `chore: 更新依赖版本` |
| `perf` | 性能优化 | `perf: 优化列表渲染性能` |

### 📄 提交信息格式

**完整格式**:
```
类型(可选的作用域): 简短描述（不超过50字）

详细说明（可选，建议添加）:
- 改动点1
- 改动点2
- 改动点3

关联问题（可选）: #issue编号
```

**示例1: 新功能**
```bash
git commit -m "feat(candidates): 添加候选人批量导入功能

实现内容:
- 支持Excel批量导入
- 数据验证和错误提示
- 导入进度显示
- 导入结果统计

测试: ✅ 1000条数据导入成功"
```

**示例2: Bug修复**
```bash
git commit -m "fix(portrait): 修复MBTI图表标签重复问题

问题: MBTI维度标签显示重复的 'E-I'
原因: dimension_parser.py 格式化逻辑错误
修复: 调整label拆分逻辑

影响: 仅MBTI画像显示"
```

---

## 五、快速提交命令

### 📌 常用命令速查

**1. 查看状态**
```bash
git status
```

**2. 查看改动**
```bash
git diff                    # 查看未暂存的改动
git diff --staged           # 查看已暂存的改动
```

**3. 添加文件**
```bash
git add 文件名              # 添加单个文件
git add frontend/           # 添加整个目录
git add .                   # 添加所有改动（谨慎）
```

**4. 提交**
```bash
git commit -m "提交信息"    # 简单提交
git commit                  # 打开编辑器写详细信息
```

**5. 推送**
```bash
git push origin master      # 推送到master分支
```

**6. 撤销操作**
```bash
git restore 文件名          # 撤销未暂存的改动
git restore --staged 文件名 # 取消暂存
git reset --soft HEAD~1     # 撤销上次提交（保留改动）
```

**7. 查看历史**
```bash
git log --oneline -10       # 查看最近10次提交
git log --graph --all       # 查看分支图
```

---

### ⚡ 一键提交脚本

创建快捷命令 `git-quick.sh`:

```bash
#!/bin/bash
# 快速提交脚本

# 检查参数
if [ $# -eq 0 ]; then
    echo "❌ 错误: 请提供提交信息"
    echo "用法: ./git-quick.sh '提交信息'"
    exit 1
fi

MESSAGE="$1"

echo "🚀 快速提交: $MESSAGE"
echo ""

# 添加所有改动
git add .

# 显示将要提交的文件
echo "📊 将要提交的文件:"
git status --short

echo ""
read -p "❓ 确认提交? (y/n): " confirm

if [ "$confirm" = "y" ]; then
    git commit -m "$MESSAGE"
    git push origin master
    echo "✅ 提交成功!"
else
    echo "❌ 取消提交"
    git reset
fi
```

**使用方法**:
```bash
chmod +x git-quick.sh
./git-quick.sh "feat: 添加新功能"
```

---

## 六、提交检查清单

### ✅ 每次提交前必须检查

**功能检查**:
- [ ] 代码可以正常运行
- [ ] 没有明显的Bug
- [ ] 关键功能已测试
- [ ] 不影响现有功能

**代码质量**:
- [ ] 代码格式正确（ESLint/Prettier）
- [ ] 没有调试用的console.log（生产代码）
- [ ] 注释充分
- [ ] 变量命名清晰

**敏感信息**:
- [ ] 没有提交 `.env` 文件
- [ ] 没有提交 API密钥
- [ ] 没有提交数据库文件（hr.db）
- [ ] 没有提交用户上传的文件

**提交信息**:
- [ ] 提交类型正确（feat/fix/docs等）
- [ ] 描述清晰易懂
- [ ] 重要改动有详细说明

---

## 七、特殊场景处理

### 🚨 场景1: 忘记提交敏感文件

**立即处理**:
```bash
# 1. 从Git追踪中移除（但保留本地文件）
git rm --cached backend/.env
git rm --cached backend/hr.db

# 2. 提交移除操作
git commit -m "chore: 移除敏感文件"

# 3. 推送
git push origin master

# 4. 确保 .gitignore 包含这些文件
echo "backend/.env" >> .gitignore
echo "backend/hr.db" >> .gitignore
git add .gitignore
git commit -m "chore: 更新.gitignore"
git push
```

---

### 🚨 场景2: 提交后发现错误

**方法1: 修改最后一次提交（未推送）**
```bash
# 修改代码
git add .
git commit --amend -m "新的提交信息"
```

**方法2: 创建新提交修复（已推送）**
```bash
# 修复代码
git add .
git commit -m "fix: 修复上次提交的问题"
git push
```

---

### 🚨 场景3: 需要回退版本

**回退到上一个版本**:
```bash
# 1. 查看提交历史
git log --oneline -5

# 2. 回退（保留改动）
git reset --soft HEAD~1

# 3. 或回退并丢弃改动（危险！）
git reset --hard HEAD~1

# 4. 强制推送（危险！仅在确认后使用）
git push origin master --force
```

---

## 八、AI助手提交承诺

### 🤖 我（AI助手）的承诺

**每次完成以下工作后，我会主动提醒并帮您提交**:

1. ✅ **完成重要功能**
   - 新增组件
   - 修改核心逻辑
   - 集成新功能

2. ✅ **修复Bug**
   - 任何Bug修复
   - 性能优化

3. ✅ **完成测试**
   - 功能测试通过
   - 验收标准达成

4. ✅ **更新文档**
   - 添加新文档
   - 更新重要说明

5. ✅ **完成每日工作**
   - 每天工作结束前
   - 长时间工作的中间节点

### 📢 提交提醒格式

当需要提交时，我会说:

> 🔔 **提交提醒**
> 
> 已完成: [功能/修复描述]
> 
> 建议提交信息:
> ```
> feat/fix/docs: [简短描述]
> 
> 详细内容:
> - [改动1]
> - [改动2]
> ```
> 
> 是否现在提交到GitHub? (y/n)

---

## 九、提交频率建议

### ⏰ 推荐提交频率

**开发阶段**（Phase 1-3）:
- 🟢 **每完成一个组件**: 立即提交
- 🟢 **每完成一个功能点**: 立即提交
- 🟢 **每修复一个Bug**: 立即提交
- 🟡 **每天工作结束**: 必须提交

**维护阶段**:
- 🟢 **重要Bug修复**: 立即提交
- 🟡 **样式调整**: 可批量提交
- 🟡 **文档更新**: 可批量提交

**最长间隔**: ⚠️ 不超过4小时不提交

---

## 十、提交统计与回顾

### 📊 每周回顾

**每周五查看提交统计**:

```bash
# 查看本周提交次数
git log --oneline --since="1 week ago" | wc -l

# 查看本周详细提交
git log --since="1 week ago" --pretty=format:"%h - %an, %ar : %s"

# 查看代码变化统计
git log --since="1 week ago" --stat
```

**健康指标**:
- ✅ 提交次数: 10-20次/周
- ✅ 提交大小: 100-500行/次
- ✅ 提交描述: 清晰完整
- ⚠️ 单次提交过大（>1000行）: 需要拆分
- ⚠️ 提交过少（<5次/周）: 需要更频繁

---

## 十一、团队协作

### 👥 如果有其他开发者

**协作流程**:

```bash
# 1. 开始工作前，先拉取最新代码
git pull origin master

# 2. 创建功能分支
git checkout -b feature/你的功能名

# 3. 在分支上开发
# ... 修改代码 ...

# 4. 提交到功能分支
git add .
git commit -m "feat: 功能描述"

# 5. 推送功能分支
git push origin feature/你的功能名

# 6. 合并到master前，先更新master
git checkout master
git pull origin master

# 7. 合并功能分支
git merge feature/你的功能名

# 8. 推送到远程
git push origin master
```

---

## 十二、总结

### ✨ 核心原则（必须记住）

1. **及时提交**: 完成就提交，不拖延
2. **描述清晰**: 让未来的你能看懂
3. **保护隐私**: 绝不提交敏感信息
4. **小步快跑**: 每次提交一个功能点

### 🎯 提交目标

**每天**:
- 至少 2-3 次有意义的提交
- 工作结束前必须提交

**每周**:
- 10-20 次提交
- 所有重要功能都已保存

**每月**:
- 代码完全同步到GitHub
- 无未提交的重要改动

---

## 📞 快速帮助

**遇到问题时**:

1. **提交冲突**: 查看 [场景2: 提交后发现错误](#🚨-场景2-提交后发现错误)
2. **忘记提交敏感信息**: 查看 [场景1: 忘记提交敏感文件](#🚨-场景1-忘记提交敏感文件)
3. **需要回退**: 查看 [场景3: 需要回退版本](#🚨-场景3-需要回退版本)

**快速命令**:
```bash
# 查看提交约定
cat Git提交约定.md

# 使用快速提交
./git-commit.sh

# 查看提交历史
git log --oneline -10
```

---

**记住: 好的提交习惯是代码安全的保障！** 🛡️

---

**生效日期**: 2025年12月11日  
**下次更新**: 根据实际情况调整

