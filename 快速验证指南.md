# EPQ 系统快速验证指南

## 问题现象

- 填写测试信息后，后台没有显示任何数据
- 顶部统计卡片为空或显示 0
- 数据列表为空

## 快速修复和验证步骤

### 步骤 1: 清空旧数据（推荐）

**为什么：** 旧版本可能使用了不同的日期格式，清空后重新测试可以避免兼容性问题。

**方法1 - 使用 debug.html：**
```bash
# 在文件管理器中双击打开 debug.html
# 或在终端执行：
cd /Users/hf/Desktop/临时/test
open debug.html
```
在打开的页面中，点击 "🗑️ 清空所有数据" 按钮。

**方法2 - 浏览器控制台：**
1. 打开 Chrome/Firefox/Safari 浏览器
2. 按 `F12` 或 `Cmd+Option+I` 打开开发者工具
3. 切换到 "Console" 标签
4. 输入并执行：
```javascript
localStorage.removeItem('epqRecords');
alert('数据已清空');
```

### 步骤 2: 生成测试数据

**方法1 - 使用 debug.html：**
1. 打开 `debug.html`（如果未打开）
2. 点击 "➕ 生成测试数据 (10条)" 按钮
3. 点击 "🔍 查看数据" 确认数据已生成

**方法2 - 使用 test_data_generator.html：**
```bash
open test_data_generator.html
```
点击 "生成 10 条测试数据" 按钮。

**方法3 - 手动填写测试：**
```bash
open test.html
```
完整填写一次测试（推荐！最真实的测试方式）

### 步骤 3: 验证后台管理页面

```bash
open admin.html
```

**登录信息：**
- 密码：`epq_admin_123`

**验证清单：**

#### ✅ 顶部统计卡片
- [ ] 总测试人数 > 0
- [ ] 应聘岗位数 > 0
- [ ] 今日新增 >= 0
- [ ] 当前筛选结果 > 0
- [ ] 高匹配占比显示正常

#### ✅ 数据表格
- [ ] 表格显示所有记录
- [ ] 提交时间显示正确（格式：YYYY-MM-DD HH:mm:ss）
- [ ] 姓名、手机号、岗位显示正确
- [ ] E、N、P、L 分数显示正确
- [ ] 岗位匹配度标签显示正确（高匹配/一般/需谨慎）

#### ✅ 筛选功能
- [ ] 岗位筛选下拉框有选项
- [ ] 日期筛选功能正常（选择日期后点击"应用筛选"）
- [ ] 关键词搜索正常（输入姓名或手机号）
- [ ] 点击"重置筛选"能清空筛选条件

#### ✅ 排序功能
- [ ] 点击"提交时间"列头可以排序
- [ ] 点击"E/N/P/L"列头可以排序
- [ ] 排序图标显示正确（↑ 或 ↓）

#### ✅ 数据可视化
- [ ] "岗位 EPQ 均值对比"图表有数据
- [ ] "匹配度分布"饼图有数据（文字完整显示）
- [ ] "提交趋势"折线图有数据

#### ✅ 导出功能
- [ ] 点击"导出 CSV"可以下载文件
- [ ] 打开 CSV 文件，提交时间和手机号有数据
- [ ] CSV 文件包含所有字段

#### ✅ 删除功能
- [ ] 勾选记录后，"删除选中"按钮可点击
- [ ] 点击删除按钮后显示确认对话框
- [ ] 确认删除后记录被删除，统计数据更新

#### ✅ 详情查看
- [ ] 点击表格行可以查看详情
- [ ] 详情弹窗显示完整信息
- [ ] EPQ 雷达图显示正确

#### ✅ 页面配置
- [ ] 点击右上角"⚙️ 页面配置"打开配置面板
- [ ] "模块显示"开关功能正常
- [ ] "岗位管理"可以添加、编辑、删除岗位
- [ ] "匹配规则配置"可以设置规则

## 常见问题排查

### 问题1: 后台仍然没有数据

**检查步骤：**

1. **确认数据已保存到 localStorage**
```bash
# 打开 debug.html
open debug.html
# 点击"查看数据"按钮
```
如果显示"localStorage 中暂无数据"，说明 test.html 提交时没有保存成功。

2. **检查浏览器控制台是否有错误**
```bash
# 打开 admin.html
open admin.html
# 按 F12 打开开发者工具
# 查看 Console 标签是否有红色错误信息
```

3. **检查文件是否为最新版本**
```bash
# 在 test.html 中搜索以下代码：
# const createTime = `${year}-${month}-${day} ${hour}:${minute}:${second}`;
```
如果没有找到，说明 test.html 还是旧版本，需要更新。

### 问题2: 顶部卡片显示 0

**可能原因：**
- 日期格式不匹配（已修复）
- 数据中的 createTime 字段为空

**解决方法：**
```bash
# 使用 debug.html 查看数据
open debug.html
# 点击"查看数据"，检查每条记录是否有 createTime 字段
```

### 问题3: 图表没有数据

**可能原因：**
- 筛选条件过滤掉了所有数据
- 数据格式不正确

**解决方法：**
1. 点击"重置筛选"按钮
2. 查看"当前筛选结果"卡片的数字是否 > 0
3. 如果仍然为 0，清空数据后重新生成

### 问题4: CSV 导出没有数据

**可能原因：**
- 没有应用筛选，导出的是空的筛选结果
- 数据字段缺失

**解决方法：**
1. 确保表格中有数据显示
2. 点击"重置筛选"确保没有过滤数据
3. 再次点击"导出 CSV"

### 问题5: 岗位管理功能不正常

**已修复！** 现在使用自定义模态框，不再依赖浏览器原生的 prompt。

**验证方法：**
1. 打开页面配置
2. 点击"添加岗位"
3. 应该看到一个居中的弹窗，而不是浏览器顶部的输入框

## 浏览器兼容性

**推荐浏览器（测试通过）：**
- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

**不推荐：**
- ❌ Internet Explorer（不支持 ES6）
- ❌ 过旧版本的浏览器

## 数据格式说明

### 标准数据格式（新版本）

```json
{
  "id": "1732695790123-abc123def",
  "name": "张三",
  "phone": "13812345678",
  "position": "Java开发工程师",
  "remark": "这是备注",
  "createTime": "2025-11-27 15:23:10",
  "scores": {
    "E": 12,
    "N": 8,
    "P": 5,
    "L": 14
  },
  "rawAnswers": {}
}
```

### 旧数据格式（兼容）

```json
{
  "id": "1732695790123-abc123def",
  "name": "张三",
  "phone": "13812345678",
  "position": "Java开发工程师",
  "remark": "这是备注",
  "createTime": "2025/11/27 下午3:23:10",
  "scores": {
    "E": 12,
    "N": 8,
    "P": 5,
    "L": 14
  },
  "rawAnswers": {}
}
```

**注意：** 新版本的 admin.html 兼容两种格式！

## 技术支持

### 调试工具

**1. debug.html**
- 用途：查看、生成、清空 localStorage 数据
- 位置：项目根目录
- 推荐：日常测试和数据管理

**2. test_data_generator.html**
- 用途：快速生成大量测试数据
- 位置：项目根目录
- 推荐：性能测试

**3. 浏览器开发者工具**
```javascript
// 查看所有数据
JSON.parse(localStorage.getItem('epqRecords'))

// 查看数据条数
JSON.parse(localStorage.getItem('epqRecords')).length

// 清空数据
localStorage.removeItem('epqRecords')

// 查看配置
JSON.parse(localStorage.getItem('epqAdminSettings'))
```

### 联系方式

如果按照以上步骤仍然无法解决问题，请提供以下信息：

1. **浏览器信息**
   - 浏览器名称和版本
   - 操作系统

2. **错误信息**
   - F12 开发者工具 Console 中的错误信息
   - 截图（如果可能）

3. **数据情况**
   - debug.html 中"查看数据"的结果
   - 数据条数和格式

4. **复现步骤**
   - 详细描述问题出现的步骤
   - 是否每次都出现

## 修复版本信息

- **版本：** v2.4
- **修复日期：** 2025-11-27
- **主要修复：**
  - ✅ 统一日期格式
  - ✅ 添加日期解析容错
  - ✅ 修复统计卡片计算
  - ✅ 修复日期筛选和排序
  - ✅ 修复图表数据显示
  - ✅ 改进岗位管理弹窗
  - ✅ 增强 CSV 导出
  - ✅ 添加调试工具

---

**祝测试顺利！** 🎉

